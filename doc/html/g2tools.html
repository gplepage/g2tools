
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>g2tools Module &#8212; g2tools 1.4 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/pyramid.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Muon g-2 from Lattice QCD using g2tools" href="overview.html" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head><body>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="overview.html" title="Muon g-2 from Lattice QCD using g2tools"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">g2tools 1.4 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="xref py py-mod docutils literal notranslate"><span class="pre">g2tools</span></code> Module</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-g2tools">
<span id="g2tools-module"></span><h1><a class="reference internal" href="#module-g2tools" title="g2tools: Least-Squares Fit to Correlators."><code class="xref py py-mod docutils literal notranslate"><span class="pre">g2tools</span></code></a> Module<a class="headerlink" href="#module-g2tools" title="Permalink to this headline">¶</a></h1>
<section id="g-2-anomaly">
<h2>g-2 Anomaly<a class="headerlink" href="#g-2-anomaly" title="Permalink to this headline">¶</a></h2>
<p>The main tool for calculating the muon’s anomaly is:</p>
<dl class="py function">
<dt class="sig sig-object py" id="g2tools.a_mu">
<span class="sig-prename descclassname"><span class="pre">g2tools.</span></span><span class="sig-name descname"><span class="pre">a_mu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vacpol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exceptions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#g2tools.a_mu" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute contribution to g-2 anomaly a_mu = (g-2)/2 from vacuum polarization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vacpol</strong> – Function of <code class="docutils literal notranslate"><span class="pre">q2</span></code> for the subtracted vacuum polarization (Pi-hat).
Here <code class="docutils literal notranslate"><span class="pre">q2</span></code> is space-like and so always positive.
(See class <a class="reference internal" href="#g2tools.vacpol" title="g2tools.vacpol"><code class="xref py py-class docutils literal notranslate"><span class="pre">vacpol</span></code></a>.)</p></li>
<li><p><strong>Q</strong> – Effective charge (in units of the proton’s charge) — for
example, <code class="docutils literal notranslate"><span class="pre">Q</span> <span class="pre">=</span> <span class="pre">1./3.</span> <span class="pre">``for</span> <span class="pre">s-quark</span> <span class="pre">loops</span> <span class="pre">(phi,</span> <span class="pre">etc)</span> <span class="pre">while</span>
<span class="pre">``Q</span> <span class="pre">=</span> <span class="pre">sqrt(5./9.)</span></code> for u/d loops (rho, etc). (Default is 1.)</p></li>
<li><p><strong>mmu</strong> – Mass of the muon (default is <code class="docutils literal notranslate"><span class="pre">g2tools.Mmu</span></code>).</p></li>
<li><p><strong>alpha</strong> – QED coupling (default is <code class="docutils literal notranslate"><span class="pre">g2tools.ALPHA</span></code>).</p></li>
<li><p><strong>qmin</strong> – Maximum <code class="docutils literal notranslate"><span class="pre">q</span></code> included in integral (default is <code class="docutils literal notranslate"><span class="pre">g2tools.QMIN</span> <span class="pre">=</span> <span class="pre">1e-15</span></code>).</p></li>
<li><p><strong>qmax</strong> – Maximum <code class="docutils literal notranslate"><span class="pre">q</span></code> included in integral (default is <code class="docutils literal notranslate"><span class="pre">g2tools.QMAX</span> <span class="pre">=</span> <span class="pre">1e5</span></code>).</p></li>
<li><p><strong>rescale</strong> – Rescales momentum in vacuum pol.: <code class="docutils literal notranslate"><span class="pre">vacpol(q2</span> <span class="pre">*</span> <span class="pre">rescale**2)</span></code>
(default is 1).</p></li>
<li><p><strong>tol</strong> – Tolerance for integral over <code class="docutils literal notranslate"><span class="pre">q2</span></code> (default is <code class="docutils literal notranslate"><span class="pre">g2tools.TOL</span> <span class="pre">=</span> <span class="pre">1e-8</span></code>).</p></li>
<li><p><strong>exceptions</strong> – If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default), an exception is raised if there
are bad poles in the <code class="docutils literal notranslate"><span class="pre">vacpol</span></code>. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, exceptions are
suppressed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Value of a_mu corresponding to <code class="docutils literal notranslate"><span class="pre">Q**2</span> <span class="pre">*</span> <span class="pre">vacpol</span></code>.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="moments">
<h2>Moments<a class="headerlink" href="#moments" title="Permalink to this headline">¶</a></h2>
<p>The main tools for creating and manipulating moments are:</p>
<dl class="py function">
<dt class="sig sig-object py" id="g2tools.moments">
<span class="sig-prename descclassname"><span class="pre">g2tools.</span></span><span class="sig-name descname"><span class="pre">moments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ainv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nlist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[4,</span> <span class="pre">6,</span> <span class="pre">8,</span> <span class="pre">10,</span> <span class="pre">12,</span> <span class="pre">14]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#g2tools.moments" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute t**n moments of correlator G.</p>
<p>Compute <code class="docutils literal notranslate"><span class="pre">sum_t</span> <span class="pre">t**n</span> <span class="pre">G(t)</span></code> for <code class="docutils literal notranslate"><span class="pre">n</span></code> in <code class="docutils literal notranslate"><span class="pre">nlist</span></code>, where both positive and
negative <code class="docutils literal notranslate"><span class="pre">t</span></code> are included.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G</strong> – Array of correlator values <code class="docutils literal notranslate"><span class="pre">G[t]</span></code> for <code class="docutils literal notranslate"><span class="pre">t=0,1...</span></code> (in
lattice units).</p></li>
<li><p><strong>Z</strong> – Renormalization factor for current (moments multiplied by <code class="docutils literal notranslate"><span class="pre">Z**2</span></code>).
Defaul is 1.</p></li>
<li><p><strong>ainv</strong> – Inverse lattice spacing used to convert moments to
physical units (n-th moment multiplied by <code class="docutils literal notranslate"><span class="pre">1/ainv**(n-2)</span></code>).
Default is 1.</p></li>
<li><p><strong>periodic</strong> – <code class="docutils literal notranslate"><span class="pre">periodic=True</span></code> implies <code class="docutils literal notranslate"><span class="pre">G[-t]</span> <span class="pre">=</span> <span class="pre">G[t]</span></code> (default);
<code class="docutils literal notranslate"><span class="pre">periodic=False</span></code> implies no periodicity in array <code class="docutils literal notranslate"><span class="pre">G[t]</span></code>
(and results doubled to account for negative <code class="docutils literal notranslate"><span class="pre">t</span></code>).</p></li>
<li><p><strong>tmin</strong> – minimum <code class="docutils literal notranslate"><span class="pre">t</span></code> value (in same units as <code class="docutils literal notranslate"><span class="pre">1/ainv</span></code>) included in
moments; ignored if <code class="docutils literal notranslate"><span class="pre">None</span></code> (default).</p></li>
<li><p><strong>tmax</strong> – maximum <code class="docutils literal notranslate"><span class="pre">t</span></code> value (in same units as <code class="docutils literal notranslate"><span class="pre">1/ainv</span></code>) included in
moments; ignored if <code class="docutils literal notranslate"><span class="pre">None</span></code> (default).</p></li>
<li><p><strong>nlist</strong> – List of moments to calculate. Default is
<code class="docutils literal notranslate"><span class="pre">nlist=[4,6,8...14]</span></code>.</p></li>
<li><p><strong>filter</strong> – Correlator <code class="docutils literal notranslate"><span class="pre">G</span></code> is replaced by <code class="docutils literal notranslate"><span class="pre">filter(G,</span> <span class="pre">t)</span></code>
before moments are calculated. Here <code class="docutils literal notranslate"><span class="pre">t</span></code> is an array of
times (in same units as <code class="docutils literal notranslate"><span class="pre">1/ainv</span></code>) corresponding
to the elements of G. Ignored if <code class="docutils literal notranslate"><span class="pre">filter=None</span></code> (default).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary <code class="docutils literal notranslate"><span class="pre">Gmom</span></code> where <code class="docutils literal notranslate"><span class="pre">Gmom[n]</span></code> is the <code class="docutils literal notranslate"><span class="pre">n-th</span></code> moment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="g2tools.mom2taylor">
<span class="sig-prename descclassname"><span class="pre">g2tools.</span></span><span class="sig-name descname"><span class="pre">mom2taylor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mom</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#g2tools.mom2taylor" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert moments in dictionary <code class="docutils literal notranslate"><span class="pre">mom</span></code> into Taylor series coefficients.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="g2tools.taylor2mom">
<span class="sig-prename descclassname"><span class="pre">g2tools.</span></span><span class="sig-name descname"><span class="pre">taylor2mom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tayl</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#g2tools.taylor2mom" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert Taylor coefficients in array <code class="docutils literal notranslate"><span class="pre">tayl</span></code> to moments.</p>
</dd></dl>

</section>
<section id="subtracted-vacuum-polarization">
<h2>Subtracted Vacuum Polarization<a class="headerlink" href="#subtracted-vacuum-polarization" title="Permalink to this headline">¶</a></h2>
<p>A subtracted vacuum polarization function (<code class="docutils literal notranslate"><span class="pre">Pi-hat</span></code>) is
represented by the following classes:</p>
<dl class="py class">
<dt class="sig sig-object py" id="g2tools.vacpol">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">g2tools.</span></span><span class="sig-name descname"><span class="pre">vacpol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exceptions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#g2tools.vacpol" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtracted vac. pol’n (<code class="docutils literal notranslate"><span class="pre">Pi-hat(q2)</span></code>) from correlator moments <code class="docutils literal notranslate"><span class="pre">g[n]</span></code>.</p>
<p>The current-current correlator is <code class="docutils literal notranslate"><span class="pre">q2</span> <span class="pre">*</span> <span class="pre">Pi(q2)</span></code>, where
<code class="docutils literal notranslate"><span class="pre">Pi-hat(q2)</span> <span class="pre">=</span> <span class="pre">Pi(q2)</span> <span class="pre">-</span> <span class="pre">Pi(0)</span></code> is the subtracted (i.e., renormalized)
vacuum polariztion function.</p>
<p>The vacuum polarization function is a Pade approximant to the Taylor
series corresponding to the moments <code class="docutils literal notranslate"><span class="pre">g[n]</span></code>.  The code estimates the
precision of the moments and sets the tolerance for the Pade determination
accordingly. The order <code class="docutils literal notranslate"><span class="pre">(m,n)</span></code> of the Pade can be specified, but might
be reduced by the code if the data are noisy.</p>
<p><a class="reference internal" href="#g2tools.vacpol" title="g2tools.vacpol"><code class="xref py py-class docutils literal notranslate"><span class="pre">vacpol</span></code></a> objects are used primarily as functions (of <em>q</em><sup>2</sup>)
but also have several attributes. Attribute <code class="docutils literal notranslate"><span class="pre">pseries</span></code> is a dictionary
containing various powerseries (see <code class="docutils literal notranslate"><span class="pre">gvar.powerseries</span></code>) describing the
function: the vacuum polarization function is <code class="docutils literal notranslate"><span class="pre">q2</span></code> times a Pade
approximant  with a numerator given by <code class="docutils literal notranslate"><span class="pre">pseries['num']</span></code> and a
denominator  given by <code class="docutils literal notranslate"><span class="pre">pseries['den']</span></code>. The Taylor series for this
function  is given by <code class="docutils literal notranslate"><span class="pre">q2</span></code> times <code class="docutils literal notranslate"><span class="pre">pseries['taylor']</span></code>.</p>
<p><a class="reference internal" href="#g2tools.vacpol" title="g2tools.vacpol"><code class="xref py py-class docutils literal notranslate"><span class="pre">vacpol</span></code></a> objects also have a method <a class="reference internal" href="#g2tools.vacpol.badpoles" title="g2tools.vacpol.badpoles"><code class="xref py py-func docutils literal notranslate"><span class="pre">vacpol.badpoles()</span></code></a> that
tests the poles in the denomator of the Pade. <code class="docutils literal notranslate"><span class="pre">badpoles(qth)</span></code> returns
<code class="docutils literal notranslate"><span class="pre">False</span></code> if any of the poles is complex or if any are located above
<code class="docutils literal notranslate"><span class="pre">-(qth</span> <span class="pre">**</span> <span class="pre">2)</span></code>. <code class="docutils literal notranslate"><span class="pre">qth</span></code> should be set equal to the threshold energy for
the correlator. If it is unset, <code class="docutils literal notranslate"><span class="pre">qth=0</span></code> is used. Lists of the
poles and their residues (for <code class="docutils literal notranslate"><span class="pre">Pi-hat(q2)</span></code>) are available in
attributes <code class="docutils literal notranslate"><span class="pre">pole</span></code> and <code class="docutils literal notranslate"><span class="pre">residue</span></code>, respectively.</p>
<p><a class="reference internal" href="#g2tools.vacpol" title="g2tools.vacpol"><code class="xref py py-class docutils literal notranslate"><span class="pre">vacpol</span></code></a> has several static methods for creating specialized
examples of vacuum polarizations (e.g., for testing):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">vacpol.fermion(m)</span></code> – 1-loop fermion (mass <code class="docutils literal notranslate"><span class="pre">m</span></code>) contribution;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vacpol.scalar(m)</span></code> – 1-loop scalar (mass <code class="docutils literal notranslate"><span class="pre">m</span></code>) contribution;</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">vacpol.vector(m,</span> <span class="pre">f)</span></code> – tree-level contribution from vector</dt><dd><p>with mass <code class="docutils literal notranslate"><span class="pre">m</span></code> and decay constant <code class="docutils literal notranslate"><span class="pre">f</span></code>.</p>
</dd>
</dl>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> – Dictionary containing moments where <code class="docutils literal notranslate"><span class="pre">g[n]</span> <span class="pre">=</span> <span class="pre">sum_t</span> <span class="pre">t**n</span> <span class="pre">G(t)</span></code>,
or array containing Taylor coefficients where
<code class="docutils literal notranslate"><span class="pre">Pi-hat(q2)</span> <span class="pre">=</span> <span class="pre">q2</span> <span class="pre">*</span> <span class="pre">sum_j</span> <span class="pre">q2**j</span> <span class="pre">*</span> <span class="pre">g[j]</span></code>.</p></li>
<li><p><strong>order</strong> – Tuple <code class="docutils literal notranslate"><span class="pre">(m,n)</span></code> specifying the order of the Pade
approximant used to approximate <code class="docutils literal notranslate"><span class="pre">Pi-hat(q2)</span></code> (the function is
approximated by <code class="docutils literal notranslate"><span class="pre">q2</span></code> times an <code class="docutils literal notranslate"><span class="pre">(m-1,n)</span></code> approximant). The
order may be reduced (automatically) if the data are too noisy. If
the order is not specified, it is set automatically according to
the number of entries in <code class="docutils literal notranslate"><span class="pre">G</span></code>.</p></li>
<li><p><strong>scale</strong> – Scale factor used to rescale <code class="docutils literal notranslate"><span class="pre">q2</span></code> so that
the Taylor coefficients are more uniform in size. This is
normally set automatically (from the first two moments),
but the automatic value is overridden if <code class="docutils literal notranslate"><span class="pre">scale</span></code> is set.</p></li>
<li><p><strong>rtol</strong> – Relative tolerance assumed when determining the
Pade approximant. This is normally set automatically
(from the standard deviations of the moments), but the
automatic value is overridden if <code class="docutils literal notranslate"><span class="pre">rtol</span></code> is specified.</p></li>
<li><p><strong>qth</strong> – Threshold for particle production: poles above <code class="docutils literal notranslate"><span class="pre">-qth**2</span></code>
are bad. Default is <code class="docutils literal notranslate"><span class="pre">qth=0</span></code>.</p></li>
<li><p><strong>warnings</strong> – <code class="docutils literal notranslate"><span class="pre">warnings=True</span></code> (default) causes a warning to be issued
when the order has been reduced automatically. <code class="docutils literal notranslate"><span class="pre">warnings=False</span></code>
suppresses the warnings.</p></li>
<li><p><strong>exceptions</strong> – If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default), an exception is raised if there
are bad poles in the <code class="docutils literal notranslate"><span class="pre">vacpol</span></code>. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, exceptions are
suppressed.</p></li>
</ul>
</dd>
</dl>
<p>Methods include:</p>
<dl class="py method">
<dt class="sig sig-object py" id="g2tools.vacpol.taylor">
<span class="sig-name descname"><span class="pre">taylor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#g2tools.vacpol.taylor" title="Permalink to this definition">¶</a></dt>
<dd><p>Return Taylor coefficients for <code class="docutils literal notranslate"><span class="pre">PI-hat(q2)/q2</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n</strong> – Maximum number of coefficients returned. Returns
all coefficents if <code class="docutils literal notranslate"><span class="pre">None</span></code> (default)/</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="g2tools.vacpol.badpoles">
<span class="sig-name descname"><span class="pre">badpoles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#g2tools.vacpol.badpoles" title="Permalink to this definition">¶</a></dt>
<dd><p>True if any pole is complex or above threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>qth</strong> – Threshold for particle production: poles above <code class="docutils literal notranslate"><span class="pre">-qth**2</span></code>
are bad. (Default is <code class="docutils literal notranslate"><span class="pre">qth=0</span></code>.)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="g2tools.vacpol.FT">
<span class="sig-name descname"><span class="pre">FT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ainv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#g2tools.vacpol.FT" title="Permalink to this definition">¶</a></dt>
<dd><p>Fourier transform of <code class="docutils literal notranslate"><span class="pre">q2</span> <span class="pre">*</span> <span class="pre">PI-hat(q2)</span></code>.</p>
<p>The Pade approximant can be decomposed into a sum of poles (partial
fractions), which give a sum of decaying exponentials when Fourier
transformed back to t-space. The amplitudes and energies of these
exponentials (for the transform of <code class="docutils literal notranslate"><span class="pre">q2</span> <span class="pre">*</span> <span class="pre">Pi-hat(q2)</span></code>) are stored in
<a class="reference internal" href="#g2tools.vacpol" title="g2tools.vacpol"><code class="xref py py-class docutils literal notranslate"><span class="pre">g2tools.vacpol</span></code></a> attributes <code class="docutils literal notranslate"><span class="pre">E</span></code> and <code class="docutils literal notranslate"><span class="pre">ampl</span></code>, respectively.</p>
<p>The decomposition into a sum of poles leaves a residual polynomial in
<code class="docutils literal notranslate"><span class="pre">q2</span></code> (zeroth-order for <code class="docutils literal notranslate"><span class="pre">(n,n)</span></code> Pades). This is ignored in the
Fourier transform since it typically affects the transform only for
very small <code class="docutils literal notranslate"><span class="pre">t</span></code>. These terms have a negligible effect (suppressed by
<code class="docutils literal notranslate"><span class="pre">a**2j</span></code> on the Taylor coefficients <code class="docutils literal notranslate"><span class="pre">Pi[j]</span></code> of <code class="docutils literal notranslate"><span class="pre">Pi-hat(q2)</span></code>
(for j&gt;=1).</p>
<p>Optional parameter <code class="docutils literal notranslate"><span class="pre">ainv</span></code> can be used to convert the Fourier
transform to lattice units (by multiplying it by <code class="docutils literal notranslate"><span class="pre">1/ainv**3</span></code>) for
comparison with simulation data. The times <code class="docutils literal notranslate"><span class="pre">t</span></code> are then
assumed to be in lattice units.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>number</em><em>, </em><em>array</em>) – Time in physical units unless <code class="docutils literal notranslate"><span class="pre">ainv</span></code>
is specified, in which case lattice units are assumed.</p></li>
<li><p><strong>ainv</strong> – Inverse lattice spacing. The Fourier transform is in lattice
units if <code class="docutils literal notranslate"><span class="pre">ainv</span></code> is specified (assuming the original
Taylor coefficients are in physical units).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="g2tools.vacpol.scalar">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_pade</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#g2tools.vacpol.scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>1-loop subt. vac. pol’n from a scalar with mass m (and charge=1).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="g2tools.vacpol.fermion">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">fermion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">19</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_pade</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#g2tools.vacpol.fermion" title="Permalink to this definition">¶</a></dt>
<dd><p>1-loop subt. vac. pol’n from a fermion with mass m (and charge=1).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="g2tools.vacpol.vector">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_pade</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#g2tools.vacpol.vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Vac. pol. due to a vector with mass <code class="docutils literal notranslate"><span class="pre">m</span></code> and decay const. <code class="docutils literal notranslate"><span class="pre">f</span></code>.</p>
<p>The decay constant is defined such that the vacuum polarization
function is <code class="docutils literal notranslate"><span class="pre">Pi-hat</span> <span class="pre">=</span> <span class="pre">q2</span> <span class="pre">*</span> <span class="pre">f**2/2/m**2</span> <span class="pre">/</span> <span class="pre">(q2</span> <span class="pre">+</span> <span class="pre">m**2)</span></code>. This
corresponds in <code class="docutils literal notranslate"><span class="pre">t</span></code> space to <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">*</span> <span class="pre">f**2</span> <span class="pre">*</span> <span class="pre">exp(-m</span> <span class="pre">*</span> <span class="pre">t)</span> <span class="pre">/</span> <span class="pre">4</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="g2tools.fourier_vacpol">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">g2tools.</span></span><span class="sig-name descname"><span class="pre">fourier_vacpol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ainv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#g2tools.fourier_vacpol" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtracted vac. pol’n (<code class="docutils literal notranslate"><span class="pre">Pi-hat(q2)</span></code>) from correlator <code class="docutils literal notranslate"><span class="pre">G(t)</span></code>.</p>
<p>The correlator is Fourier transformed to produce a function <code class="docutils literal notranslate"><span class="pre">Pi_hat</span></code>
of (Euclidean) <em>q</em><sup>2</sup> suitable for use in <a class="reference internal" href="#g2tools.a_mu" title="g2tools.a_mu"><code class="xref py py-func docutils literal notranslate"><span class="pre">g2tools.a_mu()</span></code></a>.</p>
<p>See Bernecker &amp; Meyer, EPJA47 (2011) 148 , arXiv:1107.4388 for details
on the Fouier transformation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G</strong> (<em>array</em>) – Current-current correlator in an array whose elements
are <code class="docutils literal notranslate"><span class="pre">[G(0),G(a),G(2*a),...,G(-2*a),G(-a)]</span></code> if
<code class="docutils literal notranslate"><span class="pre">periodic=True</span></code> or <code class="docutils literal notranslate"><span class="pre">[G(0),G(a),...,G(T*a-1)]</span></code>
otherwise. <code class="docutils literal notranslate"><span class="pre">G</span></code> is assumed to be in lattice units.</p></li>
<li><p><strong>Z</strong> – Renormalization factor for current (correlator multiplied
by <code class="docutils literal notranslate"><span class="pre">Z**2</span></code>). Defaul is 1.</p></li>
<li><p><strong>ainv</strong> – Inverse lattice spacing used to convert Fourier transform to
physical units. Default is 1. (Note that <code class="docutils literal notranslate"><span class="pre">G</span></code> in physical
units is obtained by multiplying <code class="docutils literal notranslate"><span class="pre">G</span></code> in lattice units by
<code class="docutils literal notranslate"><span class="pre">ainv**3</span></code>.)</p></li>
<li><p><strong>tmin</strong> – If not <code class="docutils literal notranslate"><span class="pre">None</span></code>, include only <code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">&gt;=</span> <span class="pre">tmin</span></code> (same units
as <code class="docutils literal notranslate"><span class="pre">1/ainv</span></code>).</p></li>
<li><p><strong>tmax</strong> – If not <code class="docutils literal notranslate"><span class="pre">None</span></code>, include only <code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">&lt;</span> <span class="pre">tmax</span></code> (same units
as <code class="docutils literal notranslate"><span class="pre">1/ainv</span></code>).</p></li>
<li><p><strong>periodic</strong> – <code class="docutils literal notranslate"><span class="pre">periodic=True</span></code> implies <code class="docutils literal notranslate"><span class="pre">G[-t]</span> <span class="pre">=</span> <span class="pre">G[t]</span></code> (default);
<code class="docutils literal notranslate"><span class="pre">periodic=False</span></code> implies <code class="docutils literal notranslate"><span class="pre">G[t]</span></code> is not periodic and
is specified for only non-negative <code class="docutils literal notranslate"><span class="pre">t</span></code> values
(results are doubled to account for negative <code class="docutils literal notranslate"><span class="pre">t</span></code>).</p></li>
<li><p><strong>filter</strong> – Correlator <code class="docutils literal notranslate"><span class="pre">G</span></code> is replaced by <code class="docutils literal notranslate"><span class="pre">filter(G,</span> <span class="pre">t)</span></code>
before moments are calculated. Here <code class="docutils literal notranslate"><span class="pre">t</span></code> is an array of
times (in physical units if <code class="docutils literal notranslate"><span class="pre">ainv!=1</span></code>) corresponding
to the elements of G. Ignored if <code class="docutils literal notranslate"><span class="pre">filter=None</span></code> (default).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="re-e">
<h2>R<sub>e+e-</sub><a class="headerlink" href="#re-e" title="Permalink to this headline">¶</a></h2>
<p>There are two tools for analyzing data from e+e- annihilation to hadrons (R<sub>e+e-</sub>(E)):</p>
<dl class="py function">
<dt class="sig sig-object py" id="g2tools.R2G">
<span class="sig-prename descclassname"><span class="pre">g2tools.</span></span><span class="sig-name descname"><span class="pre">R2G</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ainv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#g2tools.R2G" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate Euclidean correlator G(t) from data for R<sub>e+e-</sub>(E).</p>
<p><code class="docutils literal notranslate"><span class="pre">G(t)</span></code> is evaluated on a uniform Euclidean grid with
grid spacing <code class="docutils literal notranslate"><span class="pre">1/ainv</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">&lt;=</span> <span class="pre">T</span></code>. <code class="docutils literal notranslate"><span class="pre">G(0)</span></code> is set
equal to zero. <code class="docutils literal notranslate"><span class="pre">G(t)</span></code> is calculated in lattice units;
multiply by <code class="docutils literal notranslate"><span class="pre">ainv**3</span></code> to convert to physical units.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E</strong> (<em>array</em>) – Energies at which <code class="docutils literal notranslate"><span class="pre">R(E)</span></code> is evaluated.</p></li>
<li><p><strong>R</strong> (<em>array</em>) – <code class="docutils literal notranslate"><span class="pre">R[i]</span></code> is the R<sub>e+e-</sub> value at energy <code class="docutils literal notranslate"><span class="pre">E[i]</span></code>. This
<code class="docutils literal notranslate"><span class="pre">R[i]</span></code> may be a float or a <code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.GVar</span></code> object (Gaussian
random variable).</p></li>
<li><p><strong>ainv</strong> (<em>float</em>) – Inverse grid spacing for the t-grid in GeV.
Default is <code class="docutils literal notranslate"><span class="pre">ainv=16.</span></code>.</p></li>
<li><p><strong>T</strong> (<em>float</em>) – Length of the t-grid in inverse GeV.
Default is <code class="docutils literal notranslate"><span class="pre">T=64</span></code>.</p></li>
<li><p><strong>spline</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default) use monotonic (Steffen) spline
to evaluate the integral over <code class="docutils literal notranslate"><span class="pre">s=E**2</span></code> when calculating a_mu;
otherwise use the Trapazoidal Rule. The latter is faster but
less accurate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array <code class="docutils literal notranslate"><span class="pre">G[i]</span></code> of values of the Euclidean correlator
in lattice units on the t-grid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="g2tools.R2a_mu">
<span class="sig-prename descclassname"><span class="pre">g2tools.</span></span><span class="sig-name descname"><span class="pre">R2a_mu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#g2tools.R2a_mu" title="Permalink to this definition">¶</a></dt>
<dd><p>Calclate leading-order hadronic contribution to g-2 anomaly a_mu = (g-2)/2 from R<sub>e+e-</sub>(E).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E</strong> (<em>array</em>) – Energies at which <code class="docutils literal notranslate"><span class="pre">R(E)</span></code> is evaluated.</p></li>
<li><p><strong>R</strong> (<em>array</em>) – <code class="docutils literal notranslate"><span class="pre">R[i]</span></code> is the R<sub>e+e-</sub> value at energy <code class="docutils literal notranslate"><span class="pre">E[i]</span></code>.
<code class="docutils literal notranslate"><span class="pre">R[i]</span></code> may be a float or a <code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.GVar</span></code> object (Gaussian
random variable).</p></li>
<li><p><strong>ainv</strong> (<em>float</em>) – Inverse grid spacing for the t-grid in GeV.
Default is <code class="docutils literal notranslate"><span class="pre">ainv=16.</span></code>.</p></li>
<li><p><strong>T</strong> (<em>float</em>) – Length of the t-grid in inverse GeV.
Default is <code class="docutils literal notranslate"><span class="pre">T=64</span></code>.</p></li>
<li><p><strong>spline</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default) use monotonic (Steffen) spline
to evaluate the integral over <code class="docutils literal notranslate"><span class="pre">s=E**2</span></code> when calculating a_mu;
otherwise use the Trapazoidal Rule. The latter is faster but
less accurate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Value of a_mu corresponding to <code class="docutils literal notranslate"><span class="pre">R(E)</span></code>.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="pade-approximants">
<h2>Padé Approximants<a class="headerlink" href="#pade-approximants" title="Permalink to this headline">¶</a></h2>
<p>The following two functions are used for calculating Padé approximants from
the Taylor coefficients of an arbitrary function. The first
(<a class="reference internal" href="#g2tools.pade_svd" title="g2tools.pade_svd"><code class="xref py py-func docutils literal notranslate"><span class="pre">g2tools.pade_svd()</span></code></a>) implements an algorithm that uses <em>svd</em> cuts to
address instabilities caused  by uncertainties in the Taylor coefficients. The
second function (<a class="reference internal" href="#g2tools.pade_gvar" title="g2tools.pade_gvar"><code class="xref py py-func docutils literal notranslate"><span class="pre">g2tools.pade_gvar()</span></code></a>) is built on the first but allows
Taylor coefficients to have uncertainties (<code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.GVar</span></code>s). The statistical
uncertainties and correlations between different coefficients are propagated
through the analysis.</p>
<dl class="py function">
<dt class="sig sig-object py" id="g2tools.pade_svd">
<span class="sig-prename descclassname"><span class="pre">g2tools.</span></span><span class="sig-name descname"><span class="pre">pade_svd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-14</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#g2tools.pade_svd" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">[m,n]</span></code> Pade approximant to <code class="docutils literal notranslate"><span class="pre">sum_i</span> <span class="pre">f[i]</span> <span class="pre">x**i</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">[m,n]</span></code> Pade approximant to a series given by
<code class="docutils literal notranslate"><span class="pre">sum_i</span> <span class="pre">f[i]</span> <span class="pre">*</span> <span class="pre">x**i</span></code> is the ratio of  polynomials of order <code class="docutils literal notranslate"><span class="pre">m</span></code>
(numerator) and <code class="docutils literal notranslate"><span class="pre">n</span></code> (denominator) whose  Taylor expansion agrees
with that of the original series up to order <code class="docutils literal notranslate"><span class="pre">m+n</span></code>.</p>
<p>This code is adapted from P. Gonnet,  S. Guttel, L. N. Trefethen, SIAM
Review Vol 55, No. 1, 101 (2013). It uses an <em>svd</em> algorithm to deal with
imprecision in the input data,  here specified by the relative tolerance
<code class="docutils literal notranslate"><span class="pre">rtol</span></code> for the  input coefficients <code class="docutils literal notranslate"><span class="pre">f[i]</span></code>. It automatically reduces
the order of the approximant if the extraction of Pade coefficients
is too unstable given tolerance <code class="docutils literal notranslate"><span class="pre">rtol</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> – Array <code class="docutils literal notranslate"><span class="pre">f[i]</span></code> of power series coefficients for <code class="docutils literal notranslate"><span class="pre">i=0...n+m</span></code>.</p></li>
<li><p><strong>m</strong> – Maximum order of polynomial in numerator of Pade
approximant (<code class="docutils literal notranslate"><span class="pre">m&gt;=0</span></code>).</p></li>
<li><p><strong>n</strong> – Maximum order of polynomial in denominator of Pade
approximant (<code class="docutils literal notranslate"><span class="pre">m&gt;=0</span></code>).</p></li>
<li><p><strong>rtol</strong> – Relative accuracy of input coefficients. (Default is 1e-14.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple of power series coefficients <code class="docutils literal notranslate"><span class="pre">(p,</span> <span class="pre">q)</span></code> such that
<code class="docutils literal notranslate"><span class="pre">sum_i</span> <span class="pre">p[i]</span> <span class="pre">x**i</span></code> is the numerator of the approximant,
and <code class="docutils literal notranslate"><span class="pre">sum_i</span> <span class="pre">q[i]</span> <span class="pre">x**i</span></code> is the denominator. <code class="docutils literal notranslate"><span class="pre">q[0]</span></code> is
normalized to 1.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="g2tools.pade_gvar">
<span class="sig-prename descclassname"><span class="pre">g2tools.</span></span><span class="sig-name descname"><span class="pre">pade_gvar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gavg'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#g2tools.pade_gvar" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">[m,n]</span></code> Pade approximant to <code class="docutils literal notranslate"><span class="pre">sum_i</span> <span class="pre">f[i]</span> <span class="pre">x**i</span></code> for <code class="docutils literal notranslate"><span class="pre">GVar</span></code>s.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">[m,n]</span></code> Pade approximant to a series given by
<code class="docutils literal notranslate"><span class="pre">sum_i</span> <span class="pre">f[i]</span> <span class="pre">*</span> <span class="pre">x**i</span></code> is the ratio of  polynomials of order <code class="docutils literal notranslate"><span class="pre">m</span></code>
(numerator) and <code class="docutils literal notranslate"><span class="pre">n</span></code> (denominator) whose  Taylor expansion agrees
with that of the original series up to order <code class="docutils literal notranslate"><span class="pre">m+n</span></code>.</p>
<p>This code uses an SVD algorithm (see <a class="reference internal" href="#g2tools.pade_svd" title="g2tools.pade_svd"><code class="xref py py-func docutils literal notranslate"><span class="pre">pade_svd()</span></code></a>) to deal with
imprecision in the input data. It automatically reduces
the order of the approximant if the extraction of Pade coefficients
is too unstable given noise in the input data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> – Array <code class="docutils literal notranslate"><span class="pre">f[i]</span></code> of power series coefficients for <code class="docutils literal notranslate"><span class="pre">i=0...n+m</span></code>.</p></li>
<li><p><strong>m</strong> – Maximum order of polynomial in numerator of Pade
approximant (<code class="docutils literal notranslate"><span class="pre">m&gt;=0</span></code>).</p></li>
<li><p><strong>n</strong> – Maximum order of polynomial in denominator of Pade
approximant (<code class="docutils literal notranslate"><span class="pre">m&gt;=0</span></code>).</p></li>
<li><p><strong>rtol</strong> (<em>float</em><em> or </em><em>str</em>) – If <code class="docutils literal notranslate"><span class="pre">rtol</span></code> is a string, it determines how the
relative tolerance is determined from the relative
uncertainties in the <code class="docutils literal notranslate"><span class="pre">f[i]</span></code>. Set <code class="docutils literal notranslate"><span class="pre">rtol</span></code> equal to:
<code class="docutils literal notranslate"><span class="pre">'gavg'</span></code> for the geometric mean (default); <code class="docutils literal notranslate"><span class="pre">'avg'</span></code> for
the average; <code class="docutils literal notranslate"><span class="pre">'min'</span></code> for the minimum; or <code class="docutils literal notranslate"><span class="pre">'max'</span></code> for
the maximum. Otherwise a number can be specified, in which case
the uncertainties in <code class="docutils literal notranslate"><span class="pre">f[i]</span></code> are ignored.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple of power series coefficients <code class="docutils literal notranslate"><span class="pre">(p,</span> <span class="pre">q)</span></code> such that
<code class="docutils literal notranslate"><span class="pre">sum_i</span> <span class="pre">p[i]</span> <span class="pre">x**i</span></code> is the numerator of the approximant,
and <code class="docutils literal notranslate"><span class="pre">sum_i</span> <span class="pre">q[i]</span> <span class="pre">x**i</span></code> is the denominator. <code class="docutils literal notranslate"><span class="pre">q[0]</span></code> is
normalized to 1.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">g2tools</span></code> Module</a><ul>
<li><a class="reference internal" href="#g-2-anomaly">g-2 Anomaly</a></li>
<li><a class="reference internal" href="#moments">Moments</a></li>
<li><a class="reference internal" href="#subtracted-vacuum-polarization">Subtracted Vacuum Polarization</a></li>
<li><a class="reference internal" href="#re-e">R<sub>e+e-</sub></a></li>
<li><a class="reference internal" href="#pade-approximants">Padé Approximants</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="overview.html"
                        title="previous chapter">Muon g-2 from Lattice QCD using <code class="xref py py-mod docutils literal notranslate"><span class="pre">g2tools</span></code></a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/g2tools.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="overview.html" title="Muon g-2 from Lattice QCD using g2tools"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">g2tools 1.4 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="xref py py-mod docutils literal notranslate"><span class="pre">g2tools</span></code> Module</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, G.P. Lepage.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.2.0.
    </div>
  </body>
</html>