<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>g2tools Module &mdash; g2tools 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="g2tools 1.0 documentation" href="index.html" />
    <link rel="prev" title="Muon g-2 from Lattice QCD using g2tools" href="overview.html" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head>
  <body role="document">

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="overview.html" title="Muon g-2 from Lattice QCD using g2tools"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">g2tools 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-g2tools">
<span id="g2tools-module"></span><h1><a class="reference internal" href="#module-g2tools" title="g2tools: Least-Squares Fit to Correlators."><code class="xref py py-mod docutils literal"><span class="pre">g2tools</span></code></a> Module<a class="headerlink" href="#module-g2tools" title="Permalink to this headline">¶</a></h1>
<div class="section" id="moments">
<h2>Moments<a class="headerlink" href="#moments" title="Permalink to this headline">¶</a></h2>
<p>The main tools for creating and manipulating moments are:</p>
<dl class="function">
<dt id="g2tools.moments">
<code class="descclassname">g2tools.</code><code class="descname">moments</code><span class="sig-paren">(</span><em>G, Z=1.0, ainv=1.0, periodic=True, nlist=[4, 6, 8, 10, 12, 14, 16, 18, 20]</em><span class="sig-paren">)</span><a class="headerlink" href="#g2tools.moments" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute t**n moments of correlator G.</p>
<p>Compute <code class="docutils literal"><span class="pre">sum_t</span> <span class="pre">t**n</span> <span class="pre">G(t)</span></code> for <code class="docutils literal"><span class="pre">n</span></code> in <code class="docutils literal"><span class="pre">nlist</span></code>, where both positive and
negative <code class="docutils literal"><span class="pre">t</span></code> are included.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>G</strong> &#8211; Array of correlator values <code class="docutils literal"><span class="pre">G[t]</span></code> for <code class="docutils literal"><span class="pre">t=0,1...</span></code>.</li>
<li><strong>Z</strong> &#8211; Renormalization factor for current (moments multiplied by <code class="docutils literal"><span class="pre">Z**2</span></code>).
Defaul is 1.</li>
<li><strong>ainv</strong> &#8211; Inverse lattice spacing used to convert moments to
physical units (n-th moment multiplied by <code class="docutils literal"><span class="pre">1/ainv**(n-2)</span></code>).
Default is 1.</li>
<li><strong>periodic</strong> &#8211; <code class="docutils literal"><span class="pre">periodic=True</span></code> implies <code class="docutils literal"><span class="pre">G[-t]</span> <span class="pre">=</span> <span class="pre">G[t]</span></code> (default);
<code class="docutils literal"><span class="pre">periodic=False</span></code> implies no periodicity in array <code class="docutils literal"><span class="pre">G[t]</span></code>
(and results doubled to account for negative <code class="docutils literal"><span class="pre">t</span></code>).</li>
<li><strong>nlist</strong> &#8211; List of moments to calculate. Default is
<code class="docutils literal"><span class="pre">nlist=[4,6,8...20]</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Dictionary <code class="docutils literal"><span class="pre">Gmom</span></code> where <code class="docutils literal"><span class="pre">Gmom[n]</span></code> is the <code class="docutils literal"><span class="pre">n-th</span></code> moment.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="g2tools.mom2taylor">
<code class="descclassname">g2tools.</code><code class="descname">mom2taylor</code><span class="sig-paren">(</span><em>mom</em><span class="sig-paren">)</span><a class="headerlink" href="#g2tools.mom2taylor" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert moments in dictionary <code class="docutils literal"><span class="pre">mom</span></code> into Taylor series coefficients.</p>
</dd></dl>

<dl class="function">
<dt id="g2tools.taylor2mom">
<code class="descclassname">g2tools.</code><code class="descname">taylor2mom</code><span class="sig-paren">(</span><em>tayl</em><span class="sig-paren">)</span><a class="headerlink" href="#g2tools.taylor2mom" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert Taylor coefficients in array <code class="docutils literal"><span class="pre">tayl</span></code> to moments.</p>
</dd></dl>

</div>
<div class="section" id="subtracted-vacuum-polarization">
<h2>Subtracted Vacuum Polarization<a class="headerlink" href="#subtracted-vacuum-polarization" title="Permalink to this headline">¶</a></h2>
<p>A subtracted vacuum polarization function (<code class="docutils literal"><span class="pre">Pi-hat</span></code>) is
represented by the following class:</p>
<dl class="class">
<dt id="g2tools.vacpol">
<em class="property">class </em><code class="descclassname">g2tools.</code><code class="descname">vacpol</code><span class="sig-paren">(</span><em>g</em>, <em>order=None</em>, <em>scale=None</em>, <em>rtol=None</em><span class="sig-paren">)</span><a class="headerlink" href="#g2tools.vacpol" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtracted vac. pol&#8217;n (<code class="docutils literal"><span class="pre">Pi-hat(q2)</span></code>) from correlator moments <code class="docutils literal"><span class="pre">Gmon[n]</span></code>.</p>
<p>The vacuum polarization function is a Pade approximant to the Taylor
series corresponding to the moments <code class="docutils literal"><span class="pre">g[n]</span></code>.  The code estimates the
precision of the moments and sets the tolerance for the Pade determination
accordingly. The order <code class="docutils literal"><span class="pre">(m,n)</span></code> of the Pade can be specified, but might
be reduced by the code if the data are noisy.</p>
<p><a class="reference internal" href="#g2tools.vacpol" title="g2tools.vacpol"><code class="xref py py-class docutils literal"><span class="pre">vacpol</span></code></a> objects are used primarily as functions (of <em>q</em><sup>2</sup>)
but also have several attributes. Attribute <code class="docutils literal"><span class="pre">pseries</span></code> is a dictionary
containing various powerseries (see <code class="docutils literal"><span class="pre">gvar.powerseries</span></code>) describing the
function: the vacuum polarization function is <code class="docutils literal"><span class="pre">q2</span></code> times a Pade
approximant  with a numerator given by <code class="docutils literal"><span class="pre">pseries['num']</span></code> and a
denominator  given by <code class="docutils literal"><span class="pre">pseries['den']</span></code>. The Taylor series for this
function  is given by <code class="docutils literal"><span class="pre">q2</span></code> times <code class="docutils literal"><span class="pre">pseries['taylor']</span></code>.</p>
<p><a class="reference internal" href="#g2tools.vacpol" title="g2tools.vacpol"><code class="xref py py-class docutils literal"><span class="pre">vacpol</span></code></a> objects also have a method <code class="xref py py-func docutils literal"><span class="pre">vacpol.badpoles()</span></code> that
tests the poles in the denomator of the Pade. <code class="docutils literal"><span class="pre">badpoles(qth)</span></code> returns
<code class="docutils literal"><span class="pre">False</span></code> if any of the poles is complex or if any are located above
<code class="docutils literal"><span class="pre">-(qth</span> <span class="pre">**</span> <span class="pre">2)</span></code>. <code class="docutils literal"><span class="pre">qth</span></code> should be set equal to the threshold energy for
the correlator. If it is unset, <code class="docutils literal"><span class="pre">qth=0</span></code> is used.</p>
<p><a class="reference internal" href="#g2tools.vacpol" title="g2tools.vacpol"><code class="xref py py-class docutils literal"><span class="pre">vacpol</span></code></a> has several static methods for creating specialized
examples of vacuum polarizations (e.g., for testing):</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">vacpol.fermion(m)</span></code> &#8211; 1-loop fermion (mass <code class="docutils literal"><span class="pre">m</span></code>) contribution;</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">vacpol.scalar(m)</span></code> &#8211; 1-loop scalar (mass <code class="docutils literal"><span class="pre">m</span></code>) contribution;</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">vacpol.vector(m,</span> <span class="pre">f)</span></code> &#8211; tree-level contribution from vector</dt>
<dd><p class="first last">with mass <code class="docutils literal"><span class="pre">m</span></code> and decay constant <code class="docutils literal"><span class="pre">f</span></code>.</p>
</dd>
</dl>
</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>g</strong> &#8211; Dictionary containing moments where <code class="docutils literal"><span class="pre">g[n]</span> <span class="pre">=</span> <span class="pre">sum_t</span> <span class="pre">t**n</span> <span class="pre">G(t)</span></code>,
or array containing Taylor coefficients where
<code class="docutils literal"><span class="pre">Pi-hat(q2)</span> <span class="pre">=</span> <span class="pre">q2</span> <span class="pre">*</span> <span class="pre">sum_j</span> <span class="pre">q2**j</span> <span class="pre">*</span> <span class="pre">g[j]</span></code>.</li>
<li><strong>order</strong> &#8211; Tuple <code class="docutils literal"><span class="pre">(m,n)</span></code> specifying the order of the Pade
approximant used to approximate the function. The order may
be reduced (automatically) if the data are too noisy.
If the order is not specified, it is set automatically
according to the number of entries in <code class="docutils literal"><span class="pre">G</span></code>.</li>
<li><strong>scale</strong> &#8211; Scale factor used to rescale <code class="docutils literal"><span class="pre">q2</span></code> so that
the Taylor coefficients are more uniform in size. This is
normally set automatically (from the first two moments),
but the automatic value is overridden if <code class="docutils literal"><span class="pre">scale</span></code> is set.</li>
<li><strong>rtol</strong> &#8211; Relative tolerance assumed when determining the
Pade approximant. This is normally set automatically
(from the standard deviations of the moments), but the
automatic value is overridden if <code class="docutils literal"><span class="pre">rtol</span></code> is specified.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="pade-approximants">
<h2>Padé Approximants<a class="headerlink" href="#pade-approximants" title="Permalink to this headline">¶</a></h2>
<p>The following two functions are used for calculating Padé approximants from
the Taylor coefficients of an arbitrary function. The first
(<a class="reference internal" href="#g2tools.pade_svd" title="g2tools.pade_svd"><code class="xref py py-func docutils literal"><span class="pre">g2tools.pade_svd()</span></code></a>) implements an algorithm that uses <em>svd</em> cuts to
address instabilities caused  by uncertainties in the Taylor coefficients. The
second function (<a class="reference internal" href="#g2tools.pade_gvar" title="g2tools.pade_gvar"><code class="xref py py-func docutils literal"><span class="pre">g2tools.pade_gvar()</span></code></a>) is built on the first but allows
Taylor coefficients to have uncertainties (<code class="xref py py-class docutils literal"><span class="pre">gvar.GVar</span></code>s). The statistical
uncertainties and correlations between different coefficients are propagated
through the analysis.</p>
<dl class="function">
<dt id="g2tools.pade_svd">
<code class="descclassname">g2tools.</code><code class="descname">pade_svd</code><span class="sig-paren">(</span><em>f</em>, <em>m</em>, <em>n</em>, <em>rtol=1e-14</em><span class="sig-paren">)</span><a class="headerlink" href="#g2tools.pade_svd" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal"><span class="pre">[m,n]</span></code> Pade approximant to <code class="docutils literal"><span class="pre">sum_i</span> <span class="pre">f[i]</span> <span class="pre">x**i</span></code>.</p>
<p>The <code class="docutils literal"><span class="pre">[m,n]</span></code> Pade approximant to a series given by
<code class="docutils literal"><span class="pre">sum_i</span> <span class="pre">f[i]</span> <span class="pre">*</span> <span class="pre">x**i</span></code> is the ratio of  polynomials of order <code class="docutils literal"><span class="pre">m</span></code>
(numerator) and <code class="docutils literal"><span class="pre">n</span></code> (denominator) whose  Taylor expansion agrees
with that of the original series up to order <code class="docutils literal"><span class="pre">m+n</span></code>.</p>
<p>This code is adapted from P. Gonnet,  S. Guttel, L. N. Trefethen, SIAM
Review Vol 55, No. 1, 101 (2013). It uses an <em>svd</em> algorithm to deal with
imprecision in the input data,  here specified by the relative tolerance
<code class="docutils literal"><span class="pre">rtol</span></code> for the  input coefficients <code class="docutils literal"><span class="pre">f[i]</span></code>. It automatically reduces
the order of the approximant if the extraction of Pade coefficients
is too unstable given tolerance <code class="docutils literal"><span class="pre">rtol</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>f</strong> &#8211; Array <code class="docutils literal"><span class="pre">f[i]</span></code> of power series coefficients for <code class="docutils literal"><span class="pre">i=0...n+m</span></code>.</li>
<li><strong>m</strong> &#8211; Maximum order of polynomial in numerator of Pade
approximant (<code class="docutils literal"><span class="pre">m&gt;=0</span></code>).</li>
<li><strong>n</strong> &#8211; Maximum order of polynomial in denominator of Pade
approximant (<code class="docutils literal"><span class="pre">m&gt;=0</span></code>).</li>
<li><strong>rtol</strong> &#8211; Relative accuracy of input coefficients.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Tuple of power series coefficients <code class="docutils literal"><span class="pre">(p,</span> <span class="pre">q)</span></code> such that
<code class="docutils literal"><span class="pre">sum_i</span> <span class="pre">p[i]</span> <span class="pre">x**i</span></code> is the numerator of the approximant,
and <code class="docutils literal"><span class="pre">sum_i</span> <span class="pre">q[i]</span> <span class="pre">x**i</span></code> is the denominator. <code class="docutils literal"><span class="pre">q[0]</span></code> is
normalized to 1.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="g2tools.pade_gvar">
<code class="descclassname">g2tools.</code><code class="descname">pade_gvar</code><span class="sig-paren">(</span><em>f</em>, <em>m</em>, <em>n</em>, <em>rtol=None</em><span class="sig-paren">)</span><a class="headerlink" href="#g2tools.pade_gvar" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal"><span class="pre">[m,n]</span></code> Pade approximant to <code class="docutils literal"><span class="pre">sum_i</span> <span class="pre">f[i]</span> <span class="pre">x**i</span></code> for <code class="docutils literal"><span class="pre">GVar</span></code>s.</p>
<p>The <code class="docutils literal"><span class="pre">[m,n]</span></code> Pade approximant to a series given by
<code class="docutils literal"><span class="pre">sum_i</span> <span class="pre">f[i]</span> <span class="pre">*</span> <span class="pre">x**i</span></code> is the ratio of  polynomials of order <code class="docutils literal"><span class="pre">m</span></code>
(numerator) and <code class="docutils literal"><span class="pre">n</span></code> (denominator) whose  Taylor expansion agrees
with that of the original series up to order <code class="docutils literal"><span class="pre">m+n</span></code>.</p>
<p>This code uses an <em>svd</em> algorithm (see <a class="reference internal" href="#g2tools.pade_svd" title="g2tools.pade_svd"><code class="xref py py-func docutils literal"><span class="pre">pade_svd()</span></code></a>) to deal with
imprecision in the input data. It automatically reduces
the order of the approximant if the extraction of Pade coefficients
is too unstable given noise in the input data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>f</strong> &#8211; Array <code class="docutils literal"><span class="pre">f[i]</span></code> of power series coefficients for <code class="docutils literal"><span class="pre">i=0...n+m</span></code>.</li>
<li><strong>m</strong> &#8211; Maximum order of polynomial in numerator of Pade
approximant (<code class="docutils literal"><span class="pre">m&gt;=0</span></code>).</li>
<li><strong>n</strong> &#8211; Maximum order of polynomial in denominator of Pade
approximant (<code class="docutils literal"><span class="pre">m&gt;=0</span></code>).</li>
<li><strong>rtol</strong> &#8211; Relative accuracy of input coefficients. Overrides
default estimate from the <code class="docutils literal"><span class="pre">f[i]</span></code> unless set equal to <code class="docutils literal"><span class="pre">None</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Tuple of power series coefficients <code class="docutils literal"><span class="pre">(p,</span> <span class="pre">q)</span></code> such that
<code class="docutils literal"><span class="pre">sum_i</span> <span class="pre">p[i]</span> <span class="pre">x**i</span></code> is the numerator of the approximant,
and <code class="docutils literal"><span class="pre">sum_i</span> <span class="pre">q[i]</span> <span class="pre">x**i</span></code> is the denominator. <code class="docutils literal"><span class="pre">q[0]</span></code> is
normalized to 1.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#"><code class="docutils literal"><span class="pre">g2tools</span></code> Module</a><ul>
<li><a class="reference internal" href="#moments">Moments</a></li>
<li><a class="reference internal" href="#subtracted-vacuum-polarization">Subtracted Vacuum Polarization</a></li>
<li><a class="reference internal" href="#pade-approximants">Padé Approximants</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="overview.html"
                        title="previous chapter">Muon g-2 from Lattice QCD using <code class="docutils literal"><span class="pre">g2tools</span></code></a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="overview.html" title="Muon g-2 from Lattice QCD using g2tools"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">g2tools 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, G.P. Lepage.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>